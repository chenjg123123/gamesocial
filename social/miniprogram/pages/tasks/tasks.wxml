<navigation-bar title="任务" back="{{false}}" color="black" background="#FFF"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="page">
    <view class="top-actions">
      <button type="primary" size="mini" bindtap="doCheckin" loading="{{checkinLoading}}">到店打卡</button>
      <button size="mini" bindtap="refresh" loading="{{loading}}">刷新</button>
    </view>

    <view wx:if="{{items.length === 0}}" class="empty">暂无任务</view>
    <view wx:for="{{items}}" wx:key="id" class="card">
      <view class="row">
        <view class="left">
          <view class="title">{{item.name}}</view>
          <view class="sub">{{item.periodType}} · {{item.progressCount}}/{{item.targetCount}} · 奖励{{item.rewardPoints}}积分</view>
        </view>
        <view class="right">
          <button
            size="mini"
            type="primary"
            disabled="{{!item.canReward}}"
            data-id="{{item.id}}"
            bindtap="reward"
          >
            领取
          </button>
        </view>
      </view>
    </view>
  </view>
</scroll-view>

