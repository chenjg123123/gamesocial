<navigation-bar title="ä¸ªäººä¸­å¿ƒ" back="{{false}}" color="white" background="transparent"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="header-section">
    <view class="profile-header">
      <button class="avatar-wrapper" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
        <image class="avatar" src="{{avatarUrl || ''}}" mode="aspectFill"></image>
        <view class="avatar-edit-hint">ğŸ“·</view>
      </button>
      <view class="profile-info">
        <input class="nickname-input" placeholder="ç‚¹å‡»è®¾ç½®æ˜µç§°" placeholder-class="nickname-placeholder" value="{{nickname}}" bindinput="onNicknameInput" />
        <view class="id-tag">ID: {{userId || '-'}}</view>
      </view>
    </view>
  </view>

  <view class="page-body">
    <view class="action-card">
      <view class="action-item" bindtap="saveProfile">
        <view class="action-icon">ğŸ’¾</view>
        <view class="action-text">ä¿å­˜èµ„æ–™</view>
      </view>
      <view class="action-item" bindtap="authorizeLogin">
        <view class="action-icon">âœ…</view>
        <view class="action-text">æˆæƒç™»å½•</view>
      </view>
      <view class="action-item" bindtap="openAdmin">
        <view class="action-icon">âš™ï¸</view>
        <view class="action-text">ç®¡ç†åå°</view>
      </view>
      <view class="action-item warning" bindtap="doLogout">
        <view class="action-icon">ğŸšª</view>
        <view class="action-text">é€€å‡ºç™»å½•</view>
      </view>
    </view>

    <view class="list-section">
      <view class="section-header">
        <text class="h3">ç§¯åˆ†æµæ°´</text>
      </view>
      
      <view wx:if="{{ledger.length === 0}}" class="empty-state">
        <view class="empty-icon">ğŸ“­</view>
        <view class="empty-text">æš‚æ— æµæ°´è®°å½•</view>
      </view>

      <view wx:for="{{ledger}}" wx:key="id" class="ledger-card">
        <view class="ledger-main">
          <view class="ledger-icon">{{item.changeAmount > 0 ? 'ğŸ’°' : 'ğŸ’¸'}}</view>
          <view class="ledger-content">
            <view class="ledger-title">{{item.bizType}}</view>
            <view class="ledger-date">{{item.createdAt}}</view>
          </view>
          <view class="ledger-amount {{item.changeAmount > 0 ? 'positive' : 'negative'}}">
            {{item.changeAmount > 0 ? '+' : ''}}{{item.changeAmount}}
          </view>
        </view>
        <view class="ledger-footer">
          ä½™é¢ {{item.balanceAfter}}
        </view>
      </view>
      
      <view class="load-more" wx:if="{{hasMore}}" bindtap="loadMore">
        <text>ç‚¹å‡»åŠ è½½æ›´å¤š</text>
      </view>
    </view>
  </view>
</scroll-view>

